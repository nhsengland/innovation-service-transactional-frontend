<div class="nhsuk-grid-row">
  <div class="nhsuk-grid-column-full">

    <theme-alert [type]="alert.type" [title]="alert.title" [setFocus]="alert.setFocus">
      <p> {{ alert.message }} </p>
    </theme-alert>

    <theme-spinner *ngIf="pageStatus === 'LOADING'" cssClass="nhsuk-u-margin-9"></theme-spinner>

    <ng-container *ngIf="pageStatus === 'READY'">

      <h1 class="nhsuk-heading-l nhsuk-u-margin-bottom-5">
        {{ section.title }}
        <div class="d-block">
          <strong class="nhsuk-tag" [ngClass]="{ 'nhsuk-tag--yellow': section.status.id === 'DRAFT', 'nhsuk-tag--green': section.status.id === 'SUBMITTED'} ">
            {{ section.status.label }}
          </strong>
        </div>
      </h1>

      <button *ngIf="section.nextSectionId" routerLink="../{{ section.nextSectionId }}" class="nhsuk-button nhsuk-u-margin-right-3"> Continue to next section </button>

      <ng-container *ngIf="!section.isNotStarted">

        <div *ngIf="innovation.status === 'IN_PROGRESS' && section.status.id === 'DRAFT'" class="nhsuk-inset-text">
          <span class="nhsuk-u-visually-hidden">Information:</span>
          <p *ngIf="module === 'innovator'">
            This section is not visible to accessors because you changed it to "In draft" status, you need to submit the section if you want to share it with accessors.
          </p>
          <p *ngIf="module === 'accessor'">
            This section is not visible because the innovator has changed it status to "In Draft". If you need to see this section, you can create an action or comment asking them to resubmit.
          </p>
        </div>

        <ng-container *ngIf="summaryList.length > 0">
          <h2 class="nhsuk-heading-m">{{ module === 'innovator' ? 'Your' : 'Submitted' }} answers</h2>
          <dl class="nhsuk-summary-list">

            <ng-container *ngFor="let item of summaryList" class="nhsuk-summary-list__row">
              <ng-container [ngSwitch]="item.type">
                <ng-container *ngSwitchCase="'button'">
                  <div class="width-max-content">
                    <dt class="nhsuk-u-margin-top-5">
                      <a routerLink="edit/{{ item.editStepNumber }}" class="nhsuk-button nhsuk-button--secondary nhsuk-u-margin-0">{{ item.label }}</a>
                    </dt>
                  </div>
                </ng-container>
                <ng-container *ngSwitchDefault>
                  <div class="nhsuk-summary-list__row">
                    <dt class="nhsuk-summary-list__key">{{ item.label }}</dt>
                    <dd class="nhsuk-summary-list__value text-pre-wrap">
                      <span *ngIf="item.allowHTML" [innerHTML]="item.value"></span>
                      <span *ngIf="!item.allowHTML">{{ item.value }}</span>
                    </dd>
                    <dd class="nhsuk-summary-list__actions">
                      <a *ngIf="module === 'innovator' && item.editStepNumber" routerLink="edit/{{ item.editStepNumber }}"> Change <span class="nhsuk-u-visually-hidden"> {{ item.label | lowercase }} </span></a>
                      <a *ngIf="item.evidenceId" routerLink="evidence/{{ item.evidenceId }}"> View <span class="nhsuk-u-visually-hidden"> evidence detail </span></a>
                    </dd>
                  </div>
                </ng-container>
              </ng-container>
            </ng-container>
          </dl>
        </ng-container>

      </ng-container>

      <ng-container *ngIf="module === 'innovator'">
        <button *ngIf="section.isNotStarted" type="button" routerLink="edit" class="nhsuk-button nhsuk-u-margin-right-3"> Start now </button>
        <div>
          <button *ngIf="section.hasEvidences && !section.isNotStarted" routerLink="evidence/new" class="nhsuk-button nhsuk-button--secondary"> Add evidence </button>
        </div>
        <div>
          <button *ngIf="section.showSubmitButton" (click)="onSubmitSection()" class="nhsuk-button nhsuk-u-margin-right-3"> Confirm section answers </button>
        </div>
      </ng-container>

      <ng-container *ngIf="module === 'accessor' && (innovation.support?.status === 'ENGAGING' || innovation.support?.status === 'FURTHER_INFO_REQUIRED')">
        <button routerLink="/accessor/innovations/{{ innovation.id }}/action-tracker/new" [queryParams]="{ section: section.id }" class="nhsuk-button"> Create action for this section </button>
      </ng-container>

    </ng-container>

  </div>
</div>
